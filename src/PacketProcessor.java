import java.io.BufferedReader;
import java.io.DataInputStream;
import java.io.FileInputStream;
import java.io.InputStreamReader;
import java.util.Vector;


/**
 *
 * @author basilGeorge
 */
public class PacketProcessor {

    Vector<String> allrules = new Vector<String>();


    void loadRules()
    {

        try
        {

            FileInputStream fstream = new FileInputStream("rulesfile.txt");
           DataInputStream in = new DataInputStream(fstream);
           BufferedReader br = new BufferedReader(new InputStreamReader(in));

           String strLine;
           while ((strLine = br.readLine()) != null)   {

              allrules.add(strLine);

           }

           br.close();
           in.close();
           fstream.close();

        }
        catch(Exception e)
        {
            e.printStackTrace();
        }



    }

    boolean canForwardPacket(PacketInfo pf)
    {

       boolean res= pf.isneedDenied();
       
       if (res==true)
       {
           
           System.out.println("#######The packet must be denied");
           
       }
       

       for(int i=0;i<allrules.size();i++)
       {
              String strLine=allrules.get(i);
              String [] parts = strLine.split("#");
              if (pf.isMatch(strLine))
              {
                 System.out.println("Matched to rule " + parts[0]);
                 int lv = parts.length-1;
                 if (parts[lv].equals("1"))
                 {
                     // deny
                     return false;

                 }


              }


       }

       return true;
       


    }


}
