/**
 *
 * @author basilGeorge
 */
public class PacketInfo {

    String inport="";
    String dlsrc="";
    String dldest="";
    String dlvlan="";
    String dlvlanpcap="";
    String dltype="";
    String nwtos="";
    String nwproto="";
    String nwsrc="";
    String nwdest="";
    String tpsrc="";
    String tpdest="";


    boolean isneedDenied()
    {
         
        if (SnortGUI.hmmstates[0].getTransition(nwproto)==1)
        {
            
            if (SnortGUI.hmmstates[1].getTransition(nwsrc)==1)
            {
                
                
                if (SnortGUI.hmmstates[1].getTransition(nwdest)==1)
                {
                    
                    return true;
                }
                
            }
            
            
            
        }
        
        return false;
        
        
        
        
        
        
    }
    
    
    boolean isMatch(String line)
    {

        String [] parts = line.split("#");

        boolean [] match = new boolean[12];
        for (int i=0;i<match.length;i++)
        {
            match[i]=true;
        }


        if (parts[1].equals("NONE")==false)
        {
            if(parts[1].equals(inport)==false)
            {
                match[0]=false;
            }
        }

        if (parts[2].equals("NONE")==false)
        {
            if(parts[2].equals(dlsrc)==false)
            {
                match[1]=false;
            }
        }

        if (parts[3].equals("NONE")==false)
        {
            if(parts[3].equals(dldest)==false)
            {
                match[2]=false;
            }
        }

        if (parts[4].equals("NONE")==false)
        {
            if(parts[4].equals(dlvlan)==false)
            {
                match[3]=false;
            }
        }

        if (parts[5].equals("NONE")==false)
        {
            if(parts[5].equals(dlvlanpcap)==false)
            {
                match[4]=false;
            }
        }

        if (parts[6].equals("NONE")==false)
        {
            if(parts[6].equals(dltype)==false)
            {
                match[5]=false;
            }
        }

        if (parts[7].equals("NONE")==false)
        {
            if(parts[7].equals(nwtos)==false)
            {
                match[6]=false;
            }
        }

        if (parts[8].equals("NONE")==false)
        {
            if(parts[8].equals(nwproto)==false)
            {
                match[7]=false;
            }
        }

        if (parts[9].equals("NONE")==false)
        {
            if(parts[9].equals(nwsrc)==false)
            {
                match[8]=false;
            }
        }

        if (parts[10].equals("NONE")==false)
        {
            if(parts[10].equals(nwdest)==false)
            {
                match[9]=false;
            }
        }
        if (parts[11].equals("NONE")==false)
        {
            if(parts[11].equals(tpsrc)==false)
            {
                match[10]=false;
            }
        }
        if (parts[12].equals("NONE")==false)
        {
            if(parts[12].equals(tpdest)==false)
            {
                match[11]=false;
            }
        }

        boolean finalres=true;

        for (int i=0;i<match.length;i++)
        {
            finalres=finalres & match[i];
        }

        return finalres;

        


    }



}
